<div class="container-block disable-select">

  <div class="row" fxLayout="row" fxLayoutGap="30px">

    <mat-card class="photos" fxFlex="50">
      <div class="title">Upload photos</div>
      <div id="drag-n-drop">
        <mat-icon class="icon" fontSet="partIcon" fontIcon="part-select"></mat-icon>

        <!--hide input -->
        <input class="hide-file" type="file"
              accept="image/*" multiple="true" id="fileInput">

        <button mat-button color="primary" (click)="uploadPicture()">
          Upload a photo
        </button>
        <!-- TODO: drag n drop -->
        <!-- <p>or drag'n'drop it here</p> -->
      </div>
      <p class="widget-help">
        Upload photos of your listing item, then choose one of them as featured (this will be the main photo shown on
        market). Be sure to upload high quality &amp; focused images in good lighting where possible.
      </p>
      <div class="gallery" fxLayoutWrap>

        <div *ngFor="let image of images"
             class="photo-wrapper" fxFlex="0 0 123px" fxLayoutAlign="center center">
          <div class="photo" fxFLex>
            <img src="{{image.thumbnail}}">
            <div class="icons">
              <mat-icon class="delete" fontSet="partIcon" fontIcon="part-cross"
                        matTooltip="Remove image" (click)="removeExistingImage(image)">
              </mat-icon>
              <!--mat-icon class="featured" fontSet="partIcon" fontIcon="part-check"
                        matTooltip="Set as featured" (click)="featurePicture(i)">
              </mat-icon-->
            </div>
          </div>
        </div>

        <div *ngFor="let picture of picturesToUpload ; index as i"
             class="photo-wrapper {{i === featuredPicture ? 'featured' : ''}}" fxFlex="0 0 123px"
             fxLayoutAlign="center center">
          <!-- TODO: maybe not gif, but removing is 'unsafe' -->
          <div class="photo" fxFLex>
            <img src="{{picture}}">
            <div class="icons">
              <mat-icon class="delete" fontSet="partIcon" fontIcon="part-cross"
                        matTooltip="Remove image" (click)="removePicture(i)">
              </mat-icon>
              <mat-icon class="featured" fontSet="partIcon" fontIcon="part-check"
                        matTooltip="Set as featured" (click)="featurePicture(i)">
              </mat-icon>
            </div>
          </div>
        </div>

      </div><!-- .gallery -->
    </mat-card><!-- .photos -->

    <mat-card class="details" fxFlex="50" [formGroup]="itemFormGroup">
      <div class="title">Listing details</div>
      <mat-form-field class="full-width">
        <input matInput placeholder="Listing title (product name)" formControlName="title">
      </mat-form-field>

      <mat-form-field class="full-width">
        <textarea matInput #summary rows="3" placeholder="Summary (short description)"
                  formControlName="shortDescription"></textarea>
        <mat-hint align="end">{{ summary.value?.length || 0 }}/200</mat-hint>
      </mat-form-field>

      <mat-form-field class="full-width">
        <textarea matInput #description rows="12" placeholder="Description"
                  formControlName="longDescription"></textarea>
        <mat-hint align="end">{{ description.value?.length || 0 }}/1000</mat-hint>
      </mat-form-field>

      <mat-form-field class="full-width">
        <mat-select placeholder="Select category" formControlName="category">
          <mat-optgroup *ngFor="let group of _rootCategoryList.subCategoryList" [label]="group.name">
            <mat-option *ngFor="let subcategory of group.subCategoryList" [value]="subcategory.id" [selected]="true">
              {{ subcategory.name }}
            </mat-option>
          </mat-optgroup>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="full-width">
        <mat-select placeholder="Country" formControlName="country">
          <mat-option *ngFor="let country of countryList.getList()" value="{{country.name}}">{{country.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- TODO: add another input for fiat value and inter-connect the two: -->
      <mat-form-field class="full-width">
        <mat-icon matPrefix class="icon" fontSet="partIcon" fontIcon="part-cryptocurrency-particl"></mat-icon>
        <input matInput min="0" placeholder="Price per item" formControlName="basePrice" type="number">
        <span matSuffix>PART</span>
      </mat-form-field>

      <div class="row" fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="25px">
        <!--mat-form-field fxFlex="0 0 70px" class="auto-width">
          <input matInput placeholder="Quantity">
        </mat-form-field-->
        <mat-form-field fxFlex="50%" class="auto-width">
          <input matInput min="0" placeholder="Domestic shipping price" formControlName="domesticShippingPrice" type="number">
          <span matSuffix>PART</span>
        </mat-form-field>
        <mat-form-field fxFlex="50%" class="auto-width">
          <input matInput min="0" placeholder="International shipping price" formControlName="internationalShippingPrice"
                 type="number">
          <span matSuffix>PART</span>
        </mat-form-field>
      </div>
      <p class="widget-help">
        Don't forget to include quantity units (e.g. 1 piece, 1 pair, 1 kg or 100 ml).<br>
        Prices are in PART.
      </p>
    </mat-card>

  </div>

  <div class="action-buttons" fxLayout fxLayoutAlign="space-between center">
    <div class="left">
      <button mat-button (click)="backToSell()" color="warn">
        <mat-icon fontSet="partIcon" fontIcon="part-cross"></mat-icon>
        Cancel & Discard
      </button>
    </div>
    <div class="right">
      <button mat-button matTooltip="Save as unpublished template" (click)="saveTemplate()">
        <mat-icon fontSet="partIcon" fontIcon="part-date"></mat-icon>
        {{ isExistingTemplate() ? 'Update' : 'Save for later'}}
      </button>
      <button mat-raised-button color="primary" matTooltip="Save and put up for sale" (click)="saveAndPublish()" *ngIf="!['awaiting', 'published'].includes(preloadedTemplate?.status)">
        <mat-icon fontSet="partIcon" fontIcon="part-check"></mat-icon>
        {{ isExistingTemplate() ? 'Update & Publish' : 'Save & Publish'}}
      </button>
    </div>
  </div>

</div>
